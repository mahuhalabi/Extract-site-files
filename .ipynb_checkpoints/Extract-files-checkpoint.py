import base64
exec(base64.b64decode("IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwppbXBvcnQgb3MsIHN5cywganNvbiwgYmFzZTY0CmZyb20gQ3J5cHRvLkNpcGhlciBpbXBvcnQgQUVTLCBERVMsIERFUzMsIEJsb3dmaXNoLCBDQVNULCBBUkMyLCBDaGFDaGEyMCwgU2Fsc2EyMApmcm9tIENyeXB0by5Qcm90b2NvbC5LREYgaW1wb3J0IFBCS0RGMgpmcm9tIENyeXB0by5VdGlsLlBhZGRpbmcgaW1wb3J0IHBhZCwgdW5wYWQKCmRlZiBnZXRfaGlkZGVuX3Bhc3N3b3JkKCk6CiAgICBpbXBvcnQgYmFzZTY0CiAgICBwYXJ0MSA9IGJhc2U2NC5iNjRkZWNvZGUoIlUzVndaWEpUWldOeVpYUlFZWEowTVE9PSIpLmRlY29kZSgpCiAgICBwYXJ0MiA9IGJhc2U2NC5iNjRkZWNvZGUoIlUzVndaWEpUWldOeVpYUlFZWEowTWc9PSIpLmRlY29kZSgpCiAgICByZXR1cm4gKHBhcnQxICsgcGFydDIpLmVuY29kZSgndXRmLTgnKQoKZmlsZV9leHRlbnNpb25zID0gWycucHknLCAnLmpzJywgJy5odG1sJywgJy50eHQnLCAnLmpzb24nLCAnLnhtbCcsICcucGhwJywgJy5yYicsICcucGwnLCAnLnNoJywgJy5jJywgJy5jcHAnLCAnLmNzJywgJy5qYXZhJywgJy5nbycsICcucnMnLCAnLnN3aWZ0JywgJy5rdCcsICcubScsICcudHMnXQoKZGVmIGxvYWRfbGF5ZXJfZmlsZShmaWxlbmFtZSk6CiAgICB0cnk6CiAgICAgICAgd2l0aCBvcGVuKGZpbGVuYW1lLCAncicsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGY6CiAgICAgICAgICAgIHJldHVybiBqc29uLmxvYWQoZikKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBzeXMuZXhpdChmItiu2LfYoyDZgdmKINmC2LHYp9ih2Kkg2KfZhNmF2YTZgSB7ZmlsZW5hbWV9OiB7ZX0iKQoKZGVmIGRlY3J5cHRfbGF5ZXIoZGF0YSwgbWV0YWRhdGEsIG1hc3Rlcl9rZXkpOgogICAgbW9kZSA9IG1ldGFkYXRhWyJtb2RlIl0KICAgIHNhbHQgPSBiYXNlNjQuYjY0ZGVjb2RlKG1ldGFkYXRhWyJzYWx0Il0pCiAgICBrZXlfbGVuZ3RoID0gbWV0YWRhdGFbImtleV9sZW5ndGgiXQogICAga2V5ID0gUEJLREYyKG1hc3Rlcl9rZXksIHNhbHQsIGRrTGVuPWtleV9sZW5ndGgsIGNvdW50PTEwMDAwMCkKICAgIAogICAgaWYgbW9kZSBpbiBbIkdDTSIsICJFQVgiXToKICAgICAgICBpdiA9IGJhc2U2NC5iNjRkZWNvZGUobWV0YWRhdGFbIml2Il0pCiAgICAgICAgdGFnID0gYmFzZTY0LmI2NGRlY29kZShtZXRhZGF0YVsidGFnIl0pCiAgICAgICAgaWYgbW9kZSA9PSAiR0NNIjoKICAgICAgICAgICAgY2lwaGVyID0gQUVTLm5ldyhrZXk9a2V5LCBtb2RlPUFFUy5NT0RFX0dDTSwgbm9uY2U9aXYpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY2lwaGVyID0gQUVTLm5ldyhrZXk9a2V5LCBtb2RlPUFFUy5NT0RFX0VBWCwgbm9uY2U9aXYpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBkYXRhID0gY2lwaGVyLmRlY3J5cHRfYW5kX3ZlcmlmeShkYXRhLCB0YWcpCiAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3IgYXMgZToKICAgICAgICAgICAgc3lzLmV4aXQoZiLZgdi02YQg2KfZhNiq2K3ZgtmCINmF2YYg2KfZhNio2YrYp9mG2KfYqiDZgdmKIHttZXRhZGF0YVsnbmFtZSddfToge2V9IikKICAgIGVsaWYgbW9kZSBpbiBbIkNCQyIsICJDRkIiLCAiT0ZCIl06CiAgICAgICAgaXYgPSBiYXNlNjQuYjY0ZGVjb2RlKG1ldGFkYXRhWyJpdiJdKQogICAgICAgIGlmIG1vZGUgPT0gIkNCQyI6CiAgICAgICAgICAgIGJsb2NrX3NpemUgPSBtZXRhZGF0YS5nZXQoImJsb2NrX3NpemUiLCAxNikKICAgICAgICAgICAgIyDYp9mE2KrYo9mD2K8g2YXZhiDYo9mGINin2YTYqNmK2KfZhtin2Kog2YXYttin2LnZgdipINmE2K3YrNmFINin2YTZg9iq2YTYqQogICAgICAgICAgICBpZiBsZW4oZGF0YSkgJSBibG9ja19zaXplICE9IDA6CiAgICAgICAgICAgICAgICBwcmludChmItiq2K3YsNmK2LE6INi32YjZhCDYp9mE2KjZitin2YbYp9iqINmB2Yoge21ldGFkYXRhWyduYW1lJ119INi62YrYsSDZhdiq2LfYp9io2YIg2YXYuSDYrdis2YUg2KfZhNmD2KrZhNipICh7YmxvY2tfc2l6ZX0p2Iwg2YrYqtmFINiq2K3YtNmK2KrZh9inIikKICAgICAgICAgICAgICAgIGRhdGEgPSBwYWQoZGF0YSwgYmxvY2tfc2l6ZSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBpZiBtZXRhZGF0YVsibmFtZSJdLnN0YXJ0c3dpdGgoIkFFUyIpOgogICAgICAgICAgICAgICAgY2lwaGVyID0gQUVTLm5ldyhrZXk9a2V5LCBtb2RlPUFFUy5NT0RFX0NCQywgaXY9aXYpCiAgICAgICAgICAgIGVsaWYgbWV0YWRhdGFbIm5hbWUiXS5zdGFydHN3aXRoKCJERVMzIik6CiAgICAgICAgICAgICAgICBjaXBoZXIgPSBERVMzLm5ldyhrZXk9a2V5LCBtb2RlPURFUzMuTU9ERV9DQkMsIGl2PWl2KQogICAgICAgICAgICBlbGlmIG1ldGFkYXRhWyJuYW1lIl0uc3RhcnRzd2l0aCgiREVTIik6CiAgICAgICAgICAgICAgICBjaXBoZXIgPSBERVMubmV3KGtleT1rZXksIG1vZGU9REVTLk1PREVfQ0JDLCBpdj1pdikKICAgICAgICAgICAgZWxpZiBtZXRhZGF0YVsibmFtZSJdLnN0YXJ0c3dpdGgoIkJsb3dmaXNoIik6CiAgICAgICAgICAgICAgICBjaXBoZXIgPSBCbG93ZmlzaC5uZXcoa2V5PWtleSwgbW9kZT1CbG93ZmlzaC5NT0RFX0NCQywgaXY9aXYpCiAgICAgICAgICAgIGVsaWYgbWV0YWRhdGFbIm5hbWUiXS5zdGFydHN3aXRoKCJDQVNUIik6CiAgICAgICAgICAgICAgICBjaXBoZXIgPSBDQVNULm5ldyhrZXk9a2V5LCBtb2RlPUNBU1QuTU9ERV9DQkMsIGl2PWl2KQogICAgICAgICAgICBlbGlmIG1ldGFkYXRhWyJuYW1lIl0uc3RhcnRzd2l0aCgiQVJDMiIpOgogICAgICAgICAgICAgICAgY2lwaGVyID0gQVJDMi5uZXcoa2V5PWtleSwgbW9kZT1BUkMyLk1PREVfQ0JDLCBpdj1pdikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHN5cy5leGl0KCLYrtmI2KfYsdiy2YXZitipINi62YrYsSDZhdi52LHZiNmB2Kkg2YHZiiBDQkMiKQogICAgICAgICAgICBkZWNyeXB0ZWQgPSBjaXBoZXIuZGVjcnlwdChkYXRhKQogICAgICAgICAgICAjINil2LLYp9mE2Kkg2KfZhNit2LTZiNipINil2LDYpyDZg9in2YbYqiDZhdmI2KzZiNiv2KkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZGF0YSA9IHVucGFkKGRlY3J5cHRlZCwgYmxvY2tfc2l6ZSkKICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3IgYXMgZToKICAgICAgICAgICAgICAgIHByaW50KGYi2KrYrdiw2YrYsTog2YHYtNmEINil2LLYp9mE2Kkg2KfZhNit2LTZiNipINmB2Yoge21ldGFkYXRhWyduYW1lJ1192Iwg2YrYqtmFINin2LPYqtiu2K/Yp9mFINin2YTYqNmK2KfZhtin2Kog2KfZhNiu2KfZhToge2V9IikKICAgICAgICAgICAgICAgIGRhdGEgPSBkZWNyeXB0ZWQKICAgICAgICBlbGlmIG1vZGUgPT0gIkNGQiI6CiAgICAgICAgICAgIGlmIG1ldGFkYXRhWyJuYW1lIl0uc3RhcnRzd2l0aCgiQUVTIik6CiAgICAgICAgICAgICAgICBjaXBoZXIgPSBBRVMubmV3KGtleT1rZXksIG1vZGU9QUVTLk1PREVfQ0ZCLCBpdj1pdikKICAgICAgICAgICAgZWxpZiBtZXRhZGF0YVsibmFtZSJdLnN0YXJ0c3dpdGgoIkRFUzMiKToKICAgICAgICAgICAgICAgIGNpcGhlciA9IERFUzMubmV3KGtleT1rZXksIG1vZGU9REVTMy5NT0RFX0NGQiwgaXY9aXYpCiAgICAgICAgICAgIGVsaWYgbWV0YWRhdGFbIm5hbWUiXS5zdGFydHN3aXRoKCJERVMiKToKICAgICAgICAgICAgICAgIGNpcGhlciA9IERFUy5uZXcoa2V5PWtleSwgbW9kZT1ERVMuTU9ERV9DRkIsIGl2PWl2KQogICAgICAgICAgICBlbGlmIG1ldGFkYXRhWyJuYW1lIl0uc3RhcnRzd2l0aCgiQmxvd2Zpc2giKToKICAgICAgICAgICAgICAgIGNpcGhlciA9IEJsb3dmaXNoLm5ldyhrZXk9a2V5LCBtb2RlPUJsb3dmaXNoLk1PREVfQ0ZCLCBpdj1pdikKICAgICAgICAgICAgZWxpZiBtZXRhZGF0YVsibmFtZSJdLnN0YXJ0c3dpdGgoIkNBU1QiKToKICAgICAgICAgICAgICAgIGNpcGhlciA9IENBU1QubmV3KGtleT1rZXksIG1vZGU9Q0FTVC5NT0RFX0NGQiwgaXY9aXYpCiAgICAgICAgICAgIGVsaWYgbWV0YWRhdGFbIm5hbWUiXS5zdGFydHN3aXRoKCJBUkMyIik6CiAgICAgICAgICAgICAgICBjaXBoZXIgPSBBUkMyLm5ldyhrZXk9a2V5LCBtb2RlPUFSQzIuTU9ERV9DRkIsIGl2PWl2KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc3lzLmV4aXQoItiu2YjYp9ix2LLZhdmK2Kkg2LrZitixINmF2LnYsdmI2YHYqSDZgdmKIENGQiIpCiAgICAgICAgICAgIGRhdGEgPSBjaXBoZXIuZGVjcnlwdChkYXRhKQogICAgICAgIGVsaWYgbW9kZSA9PSAiT0ZCIjoKICAgICAgICAgICAgaWYgbWV0YWRhdGFbIm5hbWUiXS5zdGFydHN3aXRoKCJBRVMiKToKICAgICAgICAgICAgICAgIGNpcGhlciA9IEFFUy5uZXcoa2V5PWtleSwgbW9kZT1BRVMuTU9ERV9PRkIsIGl2PWl2KQogICAgICAgICAgICBlbGlmIG1ldGFkYXRhWyJuYW1lIl0uc3RhcnRzd2l0aCgiREVTMyIpOgogICAgICAgICAgICAgICAgY2lwaGVyID0gREVTMy5uZXcoa2V5PWtleSwgbW9kZT1ERVMzLk1PREVfT0ZCLCBpdj1pdikKICAgICAgICAgICAgZWxpZiBtZXRhZGF0YVsibmFtZSJdLnN0YXJ0c3dpdGgoIkRFUyIpOgogICAgICAgICAgICAgICAgY2lwaGVyID0gREVTLm5ldyhrZXk9a2V5LCBtb2RlPURFUy5NT0RFX09GQiwgaXY9aXYpCiAgICAgICAgICAgIGVsaWYgbWV0YWRhdGFbIm5hbWUiXS5zdGFydHN3aXRoKCJCbG93ZmlzaCIpOgogICAgICAgICAgICAgICAgY2lwaGVyID0gQmxvd2Zpc2gubmV3KGtleT1rZXksIG1vZGU9Qmxvd2Zpc2guTU9ERV9PRkIsIGl2PWl2KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc3lzLmV4aXQoItiu2YjYp9ix2LLZhdmK2Kkg2LrZitixINmF2LnYsdmI2YHYqSDZgdmKIE9GQiIpCiAgICAgICAgICAgIGRhdGEgPSBjaXBoZXIuZGVjcnlwdChkYXRhKQogICAgZWxpZiBtb2RlID09ICJDVFIiOgogICAgICAgIG5vbmNlID0gYmFzZTY0LmI2NGRlY29kZShtZXRhZGF0YVsibm9uY2UiXSkKICAgICAgICBjaXBoZXIgPSBBRVMubmV3KGtleT1rZXksIG1vZGU9QUVTLk1PREVfQ1RSLCBub25jZT1ub25jZSkKICAgICAgICBkYXRhID0gY2lwaGVyLmRlY3J5cHQoZGF0YSkKICAgIGVsaWYgbW9kZSBpcyBOb25lOgogICAgICAgIG5vbmNlID0gYmFzZTY0LmI2NGRlY29kZShtZXRhZGF0YVsibm9uY2UiXSkKICAgICAgICBpZiBtZXRhZGF0YVsibmFtZSJdID09ICJDaGFDaGEyMCI6CiAgICAgICAgICAgIGNpcGhlciA9IENoYUNoYTIwLm5ldyhrZXk9a2V5LCBub25jZT1ub25jZSkKICAgICAgICBlbGlmIG1ldGFkYXRhWyJuYW1lIl0gPT0gIlNhbHNhMjAiOgogICAgICAgICAgICBjaXBoZXIgPSBTYWxzYTIwLm5ldyhrZXk9a2V5LCBub25jZT1ub25jZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzeXMuZXhpdCgi2K7ZiNin2LHYstmF2YrYqSDYqNirINi62YrYsSDZhdi52LHZiNmB2KkiKQogICAgICAgIGRhdGEgPSBjaXBoZXIuZGVjcnlwdChkYXRhKQogICAgZWxzZToKICAgICAgICBzeXMuZXhpdCgi2YjYtti5INiq2LTZgdmK2LEg2LrZitixINmF2LnYsdmI2YEiKQogICAgcmV0dXJuIGRhdGEKCmRlZiBtYWluKCk6CiAgICBtYXN0ZXJfa2V5ID0gZ2V0X2hpZGRlbl9wYXNzd29yZCgpCiAgICBwYXJ0cyA9IFtdCiAgICBmb3IgaSBpbiByYW5nZSgyMCk6CiAgICAgICAgZm5hbWUgPSBmInBhcnR7aSsxfXtmaWxlX2V4dGVuc2lvbnNbaV19IgogICAgICAgIGlmIG5vdCBvcy5wYXRoLmlzZmlsZShmbmFtZSk6CiAgICAgICAgICAgIHN5cy5leGl0KGYi2KfZhNmF2YTZgSB7Zm5hbWV9INi62YrYsSDZhdmI2KzZiNivISIpCiAgICAgICAgcGFydHMuYXBwZW5kKGxvYWRfbGF5ZXJfZmlsZShmbmFtZSkpCiAgICBkYXRhID0gYmFzZTY0LmI2NGRlY29kZShwYXJ0c1stMV1bImNpcGhlcnRleHQiXSkKICAgIGZvciBsYXllciBpbiByZXZlcnNlZChwYXJ0cyk6CiAgICAgICAgZGF0YSA9IGRlY3J5cHRfbGF5ZXIoZGF0YSwgbGF5ZXJbIm1ldGFkYXRhIl0sIG1hc3Rlcl9rZXkpCiAgICB0cnk6CiAgICAgICAgZXhlYyhkYXRhLmRlY29kZSgndXRmLTgnKSwgZ2xvYmFscygpKQogICAgZXhjZXB0IFVuaWNvZGVEZWNvZGVFcnJvcjoKICAgICAgICBwcmludCgi2KrYrdiw2YrYsTog2KfZhNio2YrYp9mG2KfYqiDYp9mE2YbZh9in2KbZitipINmE2YrYs9iqINmG2LXZi9inINi12KfZhNit2YvYp9iMINmC2K8g2KrZg9mI2YYg2KrYp9mE2YHYqSIpCiAgICAgICAgc3lzLmV4aXQoMSkKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBtYWluKCkK"))